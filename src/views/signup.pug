doctype html
html 
  head
      title WanderWorte
      meta(charset='utf-8') 
      link(rel="icon", href="/images/l.png", type="image/png")
      link(rel='stylesheet', href='/output.css')
      link(rel='stylesheet', href='/style.css')

  body 
    div(id="loading-overlay" class="fixed top-0 left-0 w-screen h-screen bg-black bg-opacity-50 flex justify-center items-center z-50 hidden")
        div(class="text-blue-950 text-lg font-bold") Registering...
    div(class="space-y-12 justify-center")
        div(class="border-b border-gray-900/10 p-9 mx-20 ")
            h2(class="text-center my-5 text-2xl font-bold text-blue-900 underline ") Register Yourself to WanderWorteüåç
            p(class="mt-1 text-sm leading-6 text-gray-600") This information will be displayed publicly so be careful what you share.

            div(class="mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6")
                div(class="sm:col-span-4")
                    label(for="username" class="block text-sm font-medium leading-6 text-gray-900") Username
                    div(class="flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600 sm:max-w-md")
                        input(type="text" name="username" id="username" autocomplete="off" class="block flex-1 border-0 bg-transparent py-1.5 px-4 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6" placeholder="janesmith")
            
            div(class="col-span-full")
                label(for="about", class="block text-sm font-medium leading-6 text-gray-900") About
                div(class="mt-2")
                     textarea#about(name="about", rows="3", class="block w-full rounded-md border-0 py-1.5 px-4 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6")
                p(class="mt-3 text-sm leading-6 text-gray-600") Write a few sentences about yourself.

            div(class="col-span-full")
                label(for="photo", class="block text-sm font-medium leading-6 text-gray-900") Photo
                div(class="mt-2 flex items-center gap-x-3")
                    img(id="photo-preview", class="h-12 w-12 rounded-full object-cover", src="", alt="Photo Preview")
                    input(type="file", id="photo", name="profilePicture" class="hidden", accept="image/*")
                    label(for="photo", class="rounded-md bg-teal-400 px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 cursor-pointer") Upload Picture

            div(class="mt-10 border-b border-gray-900/10 pb-12")
                h2(class="font-semibold leading-7 text-gray-900 underline text-2xl") Personal Information
                
                div(class="mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6")
                    div(class="sm:col-span-3")
                        label(for="fullname", class="block text-sm font-medium leading-6 text-gray-900") Fullname
                        div(class="mt-2")
                          input#full-name(type="text", name="fullname", autocomplete="off", class="block w-full rounded-md border-1 py-2 px-4 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6")
        
                    div(class="sm:col-span-4")
                        label(for="email", class="block text-sm font-medium leading-6 text-gray-900") Email address
                        div(class="mt-2")
                          input#email(name="email", type="email", autocomplete="off", class="block w-full rounded-md border-1 py-1.5 px-4 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6")

                    div(class="sm:col-span-4")
                        label(for="password", class="block text-lg font-medium leading-6 text-gray-900") Create Password
                        div(class="mt-2")
                          input#password(name="password", type="text", autocomplete="off", class="block w-full rounded-md border-1 py-1.5 px-4 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6")
                          p#passwordError(class="bg-green-500 text-green-800 text-sm font-semibold hidden") Password should contain min 8 characters
                           
                    div(class="sm:col-span-3")
                        label(for="country", class="block text-sm font-medium leading-6 text-gray-900") Country
                        div(class="mt-2")
                             select#country(name="country", autocomplete="country-name", class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:max-w-xs sm:text-sm sm:leading-6")
                                option Pakistan
                                option Canada
                                option Mexico
                                option United States
                                option India
                                option Germany
                                option Austrailia
                                option Newzeland
                                option Afghanistan
                                option UAE
                                option Saudi Arabia
                                option Swizerland
                                option UK
                                option Bangladesh
                                option China 
                                option Japan
                                option Malaysia
                                option Indonesia
                    
                    div(class="mt-6 flex items-center justify-end gap-x-6")
                        button(type="button", class="text-sm font-semibold leading-6 text-gray-900") Cancel
                        button#regbtn(type="submit", class="rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600") Register‚úî
    
    
    
    //script
    script.
        const btn = document.getElementById("regbtn");
        const loadingOverlay = document.getElementById("loading-overlay");

        btn.addEventListener('click', async function(event  ) {
            event.preventDefault(); 

                loadingOverlay.classList.remove("hidden");

                let username = document.getElementById('username').value;
                let email = document.getElementById('email').value;
                const fullname = document.getElementById('full-name').value;
                const about = document.getElementById('about').value;
                let password = document.getElementById('password').value;
                const country = document.getElementById('country').value;
                const profilePicture = document.getElementById('photo').files[0];


                const formData = new FormData();
                formData.append('username', username);
                formData.append('email', email);
                formData.append('fullname', fullname);
                formData.append('about', about);
                formData.append('password', password);
                formData.append('country', country);
                formData.append('profilePicture', profilePicture);

                try {
                    const response = await fetch('/wander/v1/users/signup', {
                        method: 'POST',
                        body: formData
                    });

                    const data = await response.json();
                    
                    if (response.ok) {
                        alert("Registration successful‚ú®")
                        window.location.href = "http://localhost:3000/wander/v1/users/login";
                    }



                    if(data.message.includes("All fields are compulsory")) return alert("All fields are compulsory") 

                    if(data.message.includes("User with email or username already exists")) return alert("User with email or username already exists") 

                    if(data.message.includes("Password should contain min 8 characters")){
                        document.getElementById("passwordError").style.display = "flex"
                        return
                    } 

                    console.log('Registration successful:', data);


                } catch (error) {
                    console.error('Error registering user:', error.message);
                }finally {
                    loadingOverlay.classList.add("hidden");
                }
            });

        document.getElementById('photo').addEventListener('change', function(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        document.getElementById('photo-preview').src = e.target.result;
                    }
                    reader.readAsDataURL(file);
                }
            });



                            